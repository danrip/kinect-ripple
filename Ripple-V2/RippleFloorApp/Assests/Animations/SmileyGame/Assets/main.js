function setUpGame(){canvasWidth=window.innerWidth,canvasHeight=window.innerHeight,level+=1,document.getElementById("gameCanvas").width=canvasWidth,document.getElementById("gameCanvas").height=canvasHeight,document.getElementById("gameCanvas").style.width=canvasWidth,document.getElementById("gameCanvas").style.height=canvasHeight,document.getElementById("soundControl").play();var a=document.getElementById("gameCanvas");resetTimer=initializeTimer(),exitTimer=initializeTimer(),startGame(),a.addEventListener("mousemove",handleMouseMovement),setInterval(handleTick,100)}function startGame(){enemiesLeft=7,gameDone=!1,enemies=[];var a=gameCanvas.getContext("2d");a.fillStyle="#000000",a.fillRect(0,0,canvasWidth,canvasHeight),PlayerCord=getOffsetCoord(),EnemyCoord=getOffsetCoord(),drawPlayer(PlayerCord.x,PlayerCord.y),document.getElementById("backgroundMusic").play(),addEnemy()}function addEnemy(){var a=new Object;a.y=70+Math.random()*(canvasHeight-120),a.x=canvasWidth,a.speed=1+2*Math.random(),a.visible=!0,Math.random()>.5?a.faceColor="#FF0000":(a.faceColor="#0000FF",a.speed+=2),enemies.push(a)}function initializeTimer(){var a=new Object;return a.actualObject=null,a.value=1,a.running=!1,a.startTimer=function(){a.running=!0,a.value=1,a.actualObject=setInterval(function(){a.value+=1},1e3)},a.stopTimer=function(){clearInterval(a.actualObject),a.actualObject=null,a.running=!1},a.getTime=function(){return a.value},a}function getOffsetCoord(){var a=new Object,b=Math.random()*canvasWidth;100>b?b+=100:b>canvasWidth-100&&(b-=100),a.x=b;var c=Math.random()*canvasHeight;return 100>c?c+=100:b>canvasHeight-100&&(c-=100),a.y=c,a}function notifyWPF(){setUpGame(),window.external.loadingDone()}function configureScreen(){}function startNewGame(){enemies=[],enemyXPositions=[],enemyYPositions=[],ticksSurvived=0,level=1}function handleMouseMovement(a){playerX=a.offsetX,playerY=a.offsetY}function drawPlayer(a,b){var c=60*(window.innerHeight/800),d=document.getElementById("gameCanvas"),e=d.getContext("2d");e.strokeStyle="#0000FF",e.fillStyle="#FFFF00",e.lineWidth=4,e.beginPath(),e.arc(a,b,c,0*Math.PI,2*Math.PI,!0),e.closePath(),e.stroke(),e.fill(),e.strokeStyle="#FF0000",e.lineWidth=2,e.beginPath(),e.arc(a+20,b,c-5,.75*Math.PI,1.25*Math.PI,!1),e.stroke(),e.strokeStyle="#000000",e.fillStyle="#000000",e.beginPath(),e.arc(a+15,b+20,c-48,0*Math.PI,2*Math.PI,!1),e.closePath(),e.stroke(),e.fill(),e.strokeStyle="#000000",e.fillStyle="#000000",e.beginPath(),e.arc(a+15,b-20,c-48,0*Math.PI,2*Math.PI,!1),e.closePath(),e.stroke(),e.fill()}function drawEnemy(a,b,c){var d=60*(window.innerHeight/800),e=document.getElementById("gameCanvas"),f=e.getContext("2d");f.strokeStyle="#FFFF00",f.fillStyle=a.faceColor,f.lineWidth=4,f.beginPath(),f.arc(b,c,d,0*Math.PI,2*Math.PI,!0),f.closePath(),f.stroke(),f.fill(),f.strokeStyle="#000000",f.lineWidth=2,f.beginPath(),f.arc(b+20,c,d-5,.75*Math.PI,1.25*Math.PI,!1),f.stroke(),f.strokeStyle="#00FF00",f.fillStyle="#00FF00",f.beginPath(),f.arc(b+15,c-20,d-48,0*Math.PI,2*Math.PI,!1),f.closePath(),f.stroke(),f.fill(),f.strokeStyle="#00FF00",f.fillStyle="#00FF00",f.beginPath(),f.arc(b+15,c+20,d-48,0*Math.PI,2*Math.PI,!1),f.closePath(),f.stroke(),f.fill()}function handleTick(){if(!gameDone){var a=document.getElementById("gameCanvas"),b=0,c=enemies.length;for(Math.random()<.04&&(addEnemy(),enemyYPositions.push(0),enemyXPositions.push(Math.random()*canvasWidth));c>b;)enemies[b].x=enemies[b].x-enemies[b].speed-1,b+=1;a.width=a.width;var d=a.getContext("2d");for(d.fillStyle="#000000",d.fillRect(0,0,canvasWidth,canvasHeight),drawPlayer(playerX,playerY),b=0;c>b;)enemies[b].x<0&&(enemies[b].x=a.width,enemies[b].visible=!0,enemies[b].y=70+Math.random()*(canvasHeight-120),enemies[b].speed=(enemies.faceColor="#FF0000")?1+2*Math.random():3+2*Math.random()),enemies[b].visible&&drawEnemy(enemies[b],enemies[b].x,enemies[b].y),b+=1;for(a.getContext("2d").save(),a.getContext("2d").translate(canvasWidth-20,15),a.getContext("2d").rotate(Math.PI/2),a.getContext("2d").strokeStyle="#00FF00",a.getContext("2d").fillStyle="#00FF00",a.getContext("2d").font="72px Iceland",a.getContext("2d").textBaseline="top",a.getContext("2d").fillText("Left: "+enemiesLeft,0,0),a.getContext("2d").restore(),b=0;c>b;)enemies[b].visible&&collisionCheck(playerX,playerY,enemies[b].x,enemies[b].y)&&(document.getElementById("soundControl").play(),enemies[b].visible=!1,enemiesLeft-=1,0==enemiesLeft&&(gameDone=!0,resetCanvas("Well Done"))),b+=1;ticksSurvived+=level,level=1+Math.floor(ticksSurvived/400)}}function displayChoiceMenu(){document.getElementById("choiceMenu").style.display="block"}function hideChoiceMenu(){document.getElementById("choiceMenu").style.display="none"}function startCapture(a){switch(a){case"exit":document.getElementById("Exit").style.backgroundColor="#fff",document.getElementById("Exit").style.color="#000",exitTimer.startTimer(),setTimeout(function(){exitTimer.running&&exitTimer.getTime()>1&&(hideChoiceMenu(),window.external.executeCommand("exitGame",""))},2e3);break;case"reset":document.getElementById("Reset").style.backgroundColor="#fff",document.getElementById("Reset").style.color="#000",resetTimer.startTimer(),setTimeout(function(){resetTimer.running&&resetTimer.getTime()>1&&(hideChoiceMenu(),startGame())},2e3)}}function stopCapture(a){switch(a){case"exit":document.getElementById("Exit").style.backgroundColor="transparent",document.getElementById("Exit").style.color="#fff",exitTimer.stopTimer();case"reset":document.getElementById("Reset").style.backgroundColor="transparent",document.getElementById("Reset").style.color="#fff",resetTimer.stopTimer()}}function resetCanvas(a){document.getElementById("backgroundMusic").pause(),document.getElementById("gameEndMusic").play();var b=document.getElementById("gameCanvas");b.width=b.width;var c=b.getContext("2d");c.fillStyle="#000000",c.fillRect(0,0,canvasWidth,canvasHeight),b.getContext("2d").strokeStyle="#00FF00",b.getContext("2d").fillStyle="#00FF00",b.getContext("2d").font="72px Iceland",b.getContext("2d").textBaseline="top",c.save(),c.translate(b.width/2,b.height/2-150),c.rotate(Math.PI/2),c.textAlign="center",b.getContext("2d").fillText(a,120,0),c.restore(),displayChoiceMenu()}function collisionCheck(a,b,c,d){return(a-c)*(a-c)+(b-d)*(b-d)<4100*(window.innerHeight/800)*(window.innerHeight/800)}var enemyYPositions=[],enemyXPositions=[],enemies=[],playerX=0,playerY=0,ticksSurvived=0,mostTicksSurvived=0,canvasWidth,canvasHeight,level=0,enemiesLeft,gameDone=!1,exitTimer,resetTimer;